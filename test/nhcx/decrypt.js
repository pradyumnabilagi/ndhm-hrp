const ndm = require("../../lib");
const dotenv = require("dotenv");
dotenv.config();

const payload = {
  payload:
    "eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00iLCJ4LWhjeC1yZXF1ZXN0X2lkIjoiYjlhMTc0NTEtMmFjMC00ODdkLWE1Y2EtNmUyNDg3YzE5OTMwIiwieC1oY3gtdGltZXN0YW1wIjoiMjAyNC0wNS0wN1QxMzo1ODo0NC4xMThaIiwieC1oY3gtc2VuZGVyX2NvZGUiOiIxMDAwMDAwNDIzQHNieCIsIngtaGN4LXJlY2lwaWVudF9jb2RlIjoiMTAwMDAwMDQyM0BzYngiLCJ4LWhjeC1jb3JyZWxhdGlvbl9pZCI6IjZlYWQ3Y2VmLTM5ODAtNGJiYi1hOWJjLWIxYWIzNzk5MzhlYSIsIngtaGN4LXdvcmtmbG93X2lkIjoiZTI3ZTg1YTktM2FmMy00ZGU3LWFkYzUtNzY3NjI3ZGJiMTU3IiwieC1oY3gtc3RhdHVzIjoicmVxdWVzdC5pbml0aWF0ZSIsImtpZCI6ImV4YW1wbGUuY29tIn0.6XGFuZ5XXWbRo5WJB-KDZj0eF3MIaZSHYoNWB0USoZnST5CZnfSp1Jc6tk7SqupaxySwvf6t1n8tH8rM8aACXxB4pJevVVgTrFIUVK4gTeNPtxlIbkwvK28BYAUdRF5K5xlawp019aYYqtUU5D5pIIs_AG1okpC_htbPXvh7dpr_1b8l_62pg9_wh6f8rAJ7P1NCFdCgfpocSeylmFG1-R66Wvllm4tZYgKQKSqs_HuxXXw9yUmU6ooaWoQ6ah-4a7K0WsEvl0opVeIeIvjSxulMY5iwU7yDxOY4EJv3qAiJ03Z8UEWIe0XEMf3vzbuaNXCdY6tcboIPindnIsxbGg.5wKbb9BGCfZ95qYq.EHM3qL3g9eTf1kG7yAGS4tp0GXR3lOUXLwjSQapFkFN4-_QDfsO3k9TVcA77kKrCousyhxqArbYQyyEHHxi2dndt43jOnxU4RrPF4vDlAn-bD1iiotPsHIc8qVIfBUfxyZRU6eqZ3urXH1KeUmKLwupYFL-8WQ7Wc_AD8b9OqbafOWpiewd3GCP1rKA2IzaGSvjiPvSCyGbxkcDrhkPR_jG6e6SMFJTEE0VB_BwXgX6CeP9OVdCsYxquyIZmld8bmAdP2hyABaxorwhugmmGYUxdVe8fOHpDVtN8UQcxkbV3WiEvTj44wSY7sooER7V49M-9mH-XroJSy5F5cmhYh-lalDwroHGhR7xc3pYdxkdeOn_bQyYysGwupH3hU3NOIskgbizTB0C0sXR1k6yy_oo5Q6D5BhI3CraQYSpC3cuFnp-CNNShuR-_1WaiTejAOnVYz8SpnA5ln1VpUqEPisHI82DUAjNITBar1zKIY9BaUvUxUjYAvsIBHzew96pALdtjwlrjOJmBNsqSaxvUApAi-coRVd2zZ71M-PxYbbQS7dJH06SpzGVwjQUl4JUZl8sTSKDe8XryaXbb_PNnrC9K2KsYKgdBM7Hy3oP6Z5wob8HzUZ0MNSZCaiGahbfFKkT5mfaaZ2-w1F0d9dLV-9AMALNpCBoHtlpvSy_SBLs3bp45HrVJjAEdNMjz00gIbVB7hZNiLFNcff-42DCkXWXGlm-ZfqutnLJ7LI4eTdLXI-u78cTHRXR4DVFpn88kqrOPXRlczUuh9FLlr4-of7D5-p99yJF-keBQaXXtDj6jJmVU9oEjx0ZDL8YLPi4s3sK0AknGs7nGNpyayrq19fJK8xsLFkUnCAdTfrw1RPqR1Mvw1ajFETsKsZdOV77WlDhLVt5-SNbKGxJLmdFqSpvWcnOou2bI2mhvOJiegXcbc3qiIBA2Wvir7IgNwtQdm1GR5tiBVqGi-ekry-dQNcy4AE5WKBrriQ3U7cews9mjl3pH9YWlJ950HdKlDnig4Us6kg5qMslU9SFUtIhhWdz87KRVvE5R6FUYRyqGtA2sChp4cSJYGmAYi629F0D7J49rzpV8eyvduI2s6FlbFUKCL7Te98etl8sI_YcmAuj70C5wAKSBX9pE6B-4WKo7eJXEposAkqgFbFtr-r_Ax2VnpHg0Lrtl4el6-uVN98PF-ZxFZJeIuH3QB9Qj7ujGFoJMpUtvFpi6ukqIirynsFgwtwZpTlOCSgsJplpBe6WWe0wl5bTj2rhjxIoci6yYuiq_78xfkb1YLhHVeR1ngRvBQnhrtzPMvycFIsFRQpKOFBIOe6HvgElExAD92A_HV0qPL6kRQEFdMhc54Y9hXC2__ZgJb-OlKubAMmIbs197z0exQI1hxWIibkPjj60fIc6lB7IrSZagr_LSrtRLIO1rugGku_ItsacULCDWHuewI_t0khkYsXx6zhOyJZBA200Osv7lEJU8y2RHSX6TvH7yz0s-HOvtQnt-4zoob4vkQ9ud9eGim_A6JgQBQ3EOObLQQK_H6BgFaIdGWIU46v0pjHbCi5_3ao-wuDMGtR7YawItLdBdXjRHx1AgOJ0IVeUqLmqANHvfvugCct9pIuVkdI0YgKvpAai8efABYUGYwoDwVQv5cqeNkF57lMbB5F5VQeZb61L9JMN9zLAO57JOOn_bX-23NMrd7snamh9YxoI4xxITM_P9X-UnEw5SradZLk-b5iGtyxwSomZzxP_UcamIZRm11t5rQ1msaz5vX09TA2w-Nq2bpn_UE0XDKHRNliLMRgfMlLiHhfX3HR-bf5JELD2Q2oJK8BLa33_rXtqRR4h6rOrzKDuqMceEW8-Z0rI7WZlGAvwODl4OnKj-cgi_KXmX0ysDTmf9jMUXeDxMud0CEoEw-EeAzo832CzHeMtK3HtyssqBodc66kdYxhb1g8-iBRHatUilOacRfcPpNo3vzBBNdC8cl6dovql0wZS1SKq14WPLBlH-G54U6m1OSgA2lZAjyG9u2PeL4jYVfTLnImhs7biI-VxOMVN3ym89AMKgYJnbxH7WyJGtwC9DCkYN7u_-SC3TBuZKWB1LGpLmvb__uSbhpOrfrhoMcdwfCaXbIU-MXDiptI8_C8I4lD0m9N5BgAzk3FKnpnEEWXyhofxop4ciBtLfVI6VFeeDvzTS1uCrsIHAXDMvtmq_TuxWFcyyzO00DQ57dEhQBxKbzZMejZrLLASMAJS8ZBMAP8mIkliJZ-tpJ418kboDTd3w5QObASOevH-vjDabqtBLJzA4sCQc5p3vhE_NNp7Lq2Dn5_mUAQz6VJZbKHJp4K9dFrnUxYZ3di5jHQ5Z0tw8zesIMsgWkZx_c26_WHK1jd4TwvS2vTR-Nc6AQ_lJC06OGKIK9NkTyAXht_Idb30T9RrTgaa7ynYhSiUmNg7sA9nzmK4qHfx6gE9I4qNZaWaiWo5W98uUjIJ7C0jCU9P7CWx9Uzv_zlne8VhD-AVQyCN5ZI2JWCky5anUTaCmjwofDJH7gyoaQDE6-ooo21hFkb6G4r_tBGUZsJFeHEBhczxVV8mWFgwRDa2yIfzdw8Kzfhx4RgT1U5RYRfXpA-MjD3HJLLSI_130bTiLPsx4yORW-boRwqEhfBBFzgK6rO1xS9GcHKC1zRahEXDhmMSrpa0Cuwh10Wu9-In_uDNqtrPXjLwXRY42UVwOpYXaUF1NDGDwfMH-Sr1m-rbKH2e6mTo5KQAXgASqtY6HxJO7TVNr8nJDaNRwzY-jbstBVkYshCpNhrVijXeqmEYIoOAscvZkERYWvq00B_Adda8iDT-RB8L71fbd5gdZAM1XSoM8Dx3uXziqCQhWIwBZOcCoTMOiKNRc9KfByHU-M-r-NqLTDsI5MGqfr60KxhhsF1IXB-ZYvTQwQsjP5hJzZXzO3bdAdlgEbI4CaqUPkIO5y7sTRt7qVQ2FV1DggDG3ZNyyNuDEO-LkH5KW9RcNsiOgmVhDfS211iVkcPqsWBpRlD1w5oFBNZeP0-0KsOuY7aHefxm_yMyQHlH115_ziqbnMw32p7gFbuWu1pl-4dyyndrJG4z7SsM71ejlQ4SGtl9Q-vWUcOMgAB5MDx0vtj1JzoPGkoX-eT7lnwFSXAsOF25noIGOKqHJpacB6p-qk7YHQ-hqRz5C4BZoqW9dOAmPpxnZMt7QiL0N3mo-r680_Y419l1UOzH7q4jgbt0_yW0I1jthV3OOuydyoKi0L_igD8XTnkApScOOA9dCF_gzGtLMkG21DRf1BDkUrGZWpt2gJF8OXch-6LHpSMU3jVr6lYT2q8l5M-aV-ejZi1LVvY7b8IiApityp9wZAxoCqMRgKzXDhsBQ3KhI0F1sp-J34jfg59vXKiuYF58vbE8q7d4ryfVnrCoZ9fda8-fDLogubekGKWOSHFUZlq2mp8JvPd6Zze04b-hBoqqwO-bKW4dHqvLQe0TtN1kHiYG0t9JWTzim9TjLK0cd4L7ui3oTDxT2bopkmTuBU6dknBPrKL8WJm9eq7C2T7V7xgzAaM2LRJnBcZE81e5JWg8d5yFbfoYgL3ijmmz9yjxwN7upseTNaeFfrRBjP1iG8q8Ec6-VOHoCtqS0mQFZ8ZblKdDrrqpUS01-PESP2zqOYHwE_fs-6qnPruNEysWbeRSYdKLNJGcgggVNterVSppGS3t3qBjpWHgmt8Ug8fUV8NBAmCqq6eQiQ38CxMuq6RT3jB6u6FasPi_gnPewxY4cIPSH3NaNcoXg_6o1s6NxKG-eNy38PdHWRHzUs6flQSvloduTXlix_5Pd-n31tSDp6DxpiT-9t0VLYOlmV_TA-T5s-VgSXR-PUXvXwsVH0Th4jPFZ5fEE7hCGR9JgTe3jRwlOC6UvA_pKTI9CGd1rKAGRn2H_wsf-884wTnfu1-h9uTMUrTSG1J_1_OOjiIX8n5S6gF_CvJvgoK4u041A53qfEX7sYxyY9kr3YUv7887pwepHypZ3JTW3cic6jWsSRI-w_nGSsBKQh917pt9tkov5_btUq87DGwAe11Pl5zOXSqNYH9lbASIIuAh24f8f658haV9afS5Rdwoiigd7FzV39UrNx2so4CrIJihUzzopKjwIu9oe9t-II5f-LfWdc0r2JXHqRDFZnQQzMp8hAOeQyaESfl2OlWMEOm60d19ABTKGZXhRADK0zWDAhdOn2696JHCmUGP7OGQwoxCbBD-kWsp7Qlgn-5uD1plgZQWHWU9TawcwvRw3uhaDrx-qkfud6y0BlbjyLXivurPl-PHdEgtR12nZC1pg8Mq1O4tiKMDBwH19J7-o6Q8b7SLDx0qy6VDJ27vtWyEGTsbzF_gebNxMQr9Fy92J-uzfSNzukQsAHH_R2fgnTIPPddAcmfaiGBIYbk3oTBQtaIyOACtdC9K2uxtkKT_8eCyLnL9DbZgD2BIJPeXdcslLNU4iK9H09Ahjy4WybCWdhBADIKjbjNX4DCVo72hQ0T3oOJIjMIire0q5ugo9aYcJnJ-1FBZ6fOqQTfKunMQUTzSuY_OEg79JQ0LAL5KClZwckZU5dXY8z4X22tQEss4T4sa84zTj06KoxXAFnAXZsoKxSq8WNjS2XH4f3Vq1dnP6EQlCt6T__NUynaW58dOE4mddvrqLiKE0cB7z6309uSZU2A0QMrLBmzU_if-S2VdKCz06n_XMWWgQ8mdq0zCDnVTv4u46sm5GWgWSlncXK2pvTLRNVW1l25_EVD_U2MufrSjXNB1XkZ0QYKpJKrfPQ6UHPo1KPiwpbRBh0sSyaT1OtGGc5SUxBTlCW7aYG9SRujHvWiBYmhByjIXoHWiUGaTIdSfnB00Wr28rVVL49dCQHOMCjMbcNUdrdeEYLIuxgc29yObXX8n3FjbiIyv0YiwefJTij5e0kJW9qoL0-0J0bI6use0OZsJXGNz-4bkyEnTpEXjhn5kdMrIDnv0Sbj3X-xglOyJNL0iy110Z7axmo6A1zO8BjVK2zfi-ZMubR5oFh-dFSgDGtTeku106eipqnKqdI1mKJEWImAfOYNFMEq1E9wzxkw5_nKzaQhyt-ayzPmvq9Wv66uavWI5W7w5m64BcwkTyn-noXcMpS7LwyiJo6OSEnwiSB8bJKzeAxaQvRBQIFdyoBOEsgBkIf4juvG596eP2ENDDTwkA11pdTF28TLknQCTsrWidoIspz3ICCA3J3uV2bcHTTJ9E8VCR9P6-_XQGe9AyF60ZwuHr7OLm1Akgps9JgPdDIQFppSz2AHuPdqo6FkPq3Yuay6BdXUr4jffiLBum86dSnrRBecxIKnNqwKnrvW-Yy_3S2QlgXpK3znZpWHTN8E56fYHNXOBGr11CcrzTfjdtNqT7H2RtQccr_Rnt7hyqaosX3gpN_rukgbiAkc1BLM2h8ov7QucgbVckvSEsaMfgIUdhZVFfAej5z-R1qqOfCqqrjh6ri81RZfBWjre5UKU2YCy4-gy9cPxoN1lsaKKAerjq9RaHaFcCCNYsKPY6tLMC-MusotXnfCGRwt7ubt4D1k8bhuj6QBzdXO5DlWM8knBQqyhXMB5yXHO1zQMjt6dqtwiCidwmxYArj8d4J7aaSseTxNPCIAXnOZPgaXgn3TNz1SnrAcobrFJlYiNx6epfaq8YNvZAbcl-mtR1Te-8uVmvO5d7NU8geCMzcBzkurLEByUlnmMuXcSKr6hpKlx6VDLuFgmYSfZXUhAjywxn_s5REmTQeUyUwuqCewesBOSyXpQN5CWj9-10YaUBuvY-NpHuGwGGpz2g0konRzV60zdNXpqy8e7wcSmOtcLQjRGmkCSMHwnyrReCSKhGtRp_X6wS42TH3cqX_NFmwZeGJ1nQcvQqJXEwLpf9w8H71IT1mD09WqHIcrCmG3CyhsBzHlEu-wXezKx0yxJE816eWhA4U_Oh77k2o-4g-OE1w7OlrLRHJ3K3d0Uvp-DlV3Maxiien5ZfD1fBf2oRUTCpmFj3pbHw_Llyp96iKy5CdBZmRH1smD1tVGSGjkQxTGlxoFx9-2xLqQfBkABMNfe6fczBjl6e1cZ_VB3HNxsOwbJzli9Dyq6w-E0hIW3nhK-5AlOAjY0m5XXjb6_YmtuZhcKBaicTzKj6-swBby6brTL5h1po6iL82xwHJ5qvOAAYfrpFvAsfJv0PpS-hiCYMZmKNxwB38O2Z_izakOp7AAyyKhJ-iWCSDm9cxkhyXDgHDaVW_xUeutq9tXkM41we5BdkP9qfYXD7lJzTKcztIrAxhFG2-afjRvc4pa4rjI0HOpqhMM5eHK_x3eFjT1zHhM4yRYOwewA3EpLi8Z91GH7WXholxCRbQ3Ppm-Rl206FS_Q8XdoQVKVufmTyxW_k93F3lMZKJRcLRkSUgyRqhykLLs04d_YIof-SpsdDn5i-CjElhMObxANzyD2QfDi0ZbjOATIeycAb1qHsUexJeBqZ4h4cKbBbWIJEK3TokYtpzjabf1l9ZM1h0n5K8376ZfH5vRW6mn4UyqnfxMi6IDngsLWqAeyE-I8j2pHBNsMIeQlOsSe68I7xwnPqfjOM6QjvzuT63OA_O1-RoHog2HjvZd6cj0-tlBKKwCkUZqSCU1Qei4_kSa_xRaAK8vUNeSNar6kl2ykG7uJTk2bJ6Qdom9S0EGXqFwDVTmoVC8OUnu6n2pEh0QIwkCU9VPLe0vpOsXygp0K6NRADuNQDpf2PtkTZ-6Al4P2fsox2fgP4WwK0G8vBVsFBNaOL-AucayvcPQKiQ84EjCud_PqnrD5r93uYZ-hin0z7YhbAa0DwBA4Hlc6m6TBvv0jiUpDOnEr-7aOMXyl3_-Gdn8MSrI5uF7hTYP-B6bXYzV--mPc10rU8jyueh8ouFdQHb8DbXo-uazLKnVuDp_Vz1nVRYXwf-pZpm_BajF9j-Dl65mNgEWE0QFOVOTpGNxTGzwX_NY9KF85fLUNezbcUGf6JXxSODInKp9WoOAiuCkXIWodUxxSOQW5rU-jMcy9jPFnewpS-6zKrjr8BYYDYZTOI2vzRbVGWpoEwotORVt_5gKNc_Bbny0W3awGyZITs945EqEmP9xMMcyjc2oIihdGAeJAVDNdfEMNSBMY3qSD3oHDJNctQhOjv_X5kEfXR7vgau5tPdICmDTrdGFh1lzMN3AgwKY2Vuxb9Jcot97gNTx73Jrbjg4zoq0Cx4NNYqNUnEreU-cH7iti6mUHK7mrBlhVukpUcHuwsIU4ELDIwxyxNHQXnmTZgbmssASsnaYT7Hl8OcfrDLpwgAL-OiYOX1qSFOg7oB7E1tXnhWv7r0swEwl17J_IgU8EWw8uSQ1UJ9GwNeJdovl3rVpD_s9Nc_3BfiEzvkMFy06nSFQYDFxGyoaxWAaLdzR-WMnrSwz4KWZcKHMJj8EurtV7UvtpIY1Yb3nmpb9rAdZhe6Ev0QU6I3OVy7NL4f59ouHl6rZFtEoTEm2cu6vonulc_umwbVuPBkszRLVKExeXJ2nrdeyo9rLwt6PbgrZCfJfrYyzi2sZ3BnpwtuWuvk_BbChBVSKmT5hmm0rVr5G2lAAriEJ0dpQ0QCByxzUfRQxBrSiTjSu-QZgIIkQ1fbLDOfkpgjbFhLhDtkLvoDRfeFj9Oyu5C_1G9oVsFCf_6XBG3Wy7IdtxnHoF_MVLrIdEDhNCj24dVLsQ0OxAdsK1E11IXCSBep7_j33BopHSQ_ZvHeH4BfX4ggG6LGIvFfA-6m4-pooQ0vv1j6NRbJ-9WP4O2Vdjkhckls5zEv_oerJcv-QldS27VOWrmMYzvzd4huoV0eV3lyaAVpD1IZyU0d9Ssxu0DUcum-BzeDPj91-T9WAYX0fhzQyd4Ktl1S_mrYg52StOSojIhHw7GaLolPxHAfKapzKdEUe3TRPDy.zvRUQEMVjAAgIoL9NeVl7A",
};

const decrpytmethod = async () => {
  const fs = require("fs");
  const privateCert = fs.readFileSync("./keys/private_key_pkcs8.pem", "utf8");
  const publicCert = fs.readFileSync("./keys/public_cert.pem", "utf8");
  const decrypt = new ndm.NhcxIncommingRequest({
    encryptionPrivateKey: privateCert,
  });

  const ret = await decrypt.process({
    payload: payload,
    privateKey: privateCert,
    publicCert: publicCert,
  });

  console.log(JSON.parse(ret));
};

decrpytmethod();
